<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××œ×•× ×™× 8 - ××¡×š ×œ×•×‘×™ ×—×›×</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0a1628',
                        secondary: '#0f2847',
                        surface: '#1a3a5c',
                        surfaceAlt: '#2a4a6c',
                        accent: '#3b82f6',
                        accentLight: '#60a5fa',
                        textPrimary: '#ffffff',
                        textSecondary: '#94a3b8',
                        textMuted: '#64748b',
                        cardBg: '#ffffff',
                        cardBorder: '#e2e8f0',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                    },
                    fontFamily: {
                        heebo: ['Heebo', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Heebo', sans-serif; }
        html, body { height: 100%; overflow: hidden; }
        body { background: linear-gradient(135deg, #0a1628 0%, #0f2847 100%); }
        
        .notices-scroll::-webkit-scrollbar { width: 6px; }
        .notices-scroll::-webkit-scrollbar-track { background: #f1f5f9; border-radius: 3px; }
        .notices-scroll::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 3px; }
        .notices-scroll::-webkit-scrollbar-thumb:hover { background: #2563eb; }
        
        @keyframes marquee-rtl {
            0% { transform: translateX(0%); }
            100% { transform: translateX(50%); }
        }
        .marquee-content {
            animation: marquee-rtl 60s linear infinite;
            display: flex;
            white-space: nowrap;
        }
        .marquee-content:hover { animation-play-state: paused; }
        
        @keyframes priority-pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(239, 68, 68, 0); }
        }
        .priority-notice {
            animation: priority-pulse 2s ease-in-out infinite;
            border-right-color: #ef4444 !important;
        }
        
        .modal-backdrop {
            background-color: rgba(10, 22, 40, 0.85);
            backdrop-filter: blur(8px);
        }
        
        .color-option {
            width: 28px; height: 28px; border-radius: 50%;
            cursor: pointer; transition: transform 0.2s ease;
            border: 2px solid transparent;
        }
        .color-option:hover { transform: scale(1.15); }
        .color-option.selected { border-color: #1e293b; box-shadow: 0 0 0 2px white; }
        
        .dashboard-card {
            background: white; border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }
        .dashboard-card-dark {
            background: linear-gradient(145deg, #1a3a5c 0%, #0f2847 100%);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .notice-item {
            background: #f8fafc; border-right: 4px solid #3b82f6;
            border-radius: 12px; transition: all 0.2s ease;
        }
        .notice-item:hover { background: #f1f5f9; transform: translateX(-2px); }
        
        .admin-btn {
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }
        .admin-btn:hover { transform: scale(1.05); box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4); }
        
        .shabbat-card { background: linear-gradient(145deg, #1e40af 0%, #1e3a8a 100%); }
        .time-display { font-variant-numeric: tabular-nums; letter-spacing: -0.02em; }
        .ticker-container { background: linear-gradient(90deg, #0f2847 0%, #1a3a5c 50%, #0f2847 100%); }

        .notice-content {
            white-space: pre-line;
        }

        .ynet-icon {
            width: 22px;
            height: 22px;
            border-radius: 9999px;
            background-color: #e50914;
            color: #ffffff;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 13px;
            flex-shrink: 0;
        }
    </style>
</head>
<body class="font-heebo text-white">
    
    <!-- ==================== TOP BAR ==================== -->
    <header class="bg-secondary py-3 px-6 shadow-lg">
        <div class="flex items-center justify-between max-w-[1920px] mx-auto">
            <!-- Left: Time/Date/Weather Widget -->
            <div class="flex items-center gap-6 bg-primary/50 rounded-xl px-5 py-3">
                <div class="text-right">
                    <div id="header-time" class="text-4xl font-bold time-display">--:--</div>
                </div>
                <div class="text-right border-r border-white/20 pr-5">
                    <div id="header-date" class="text-sm text-textSecondary">--</div>
                    <div id="header-day" class="text-base font-medium">---</div>
                </div>
                <div class="flex items-center gap-2 border-r border-white/20 pr-5">
                    <span id="header-weather-icon" class="text-2xl">â˜€ï¸</span>
                    <span id="header-weather-temp" class="text-xl font-semibold">--Â°</span>
                </div>
            </div>
            
            <!-- Center: Building Title -->
            <div class="absolute left-1/2 transform -translate-x-1/2 flex items-center gap-4">
                <h1 class="text-3xl lg:text-4xl font-bold tracking-tight">×‘×¨×•×›×™× ×”×‘××™× ×œ××œ×•× ×™× 8</h1>
                <div class="text-4xl">ğŸ¢</div>
            </div>
            
            <!-- Right: Empty space for balance -->
            <div class="w-[280px]"></div>
        </div>
    </header>
    
    <!-- ==================== MAIN DASHBOARD ==================== -->
    <main class="h-[calc(100vh-140px)] p-4 lg:p-6">
        <div class="grid grid-cols-12 gap-5 h-full max-w-[1920px] mx-auto">
            
            <!-- ==================== LEFT COLUMN: News ==================== -->
            <div class="col-span-12 lg:col-span-3 flex flex-col">
                <div class="dashboard-card flex-1 flex flex-col overflow-hidden">
                    <div class="bg-gradient-to-l from-accent to-blue-600 px-4 py-3 rounded-t-2xl">
                        <h2 class="text-lg font-bold flex items-center gap-2">ğŸ“° ×—×“×©×•×ª ×•×¢×“×›×•× ×™×</h2>
                    </div>
                    <div class="flex-1 overflow-y-auto p-3 space-y-2" id="news-headlines">
                        <div class="text-center text-gray-400 py-8">
                            <div class="text-3xl mb-2">ğŸ“¡</div>
                            <p class="text-sm">×˜×•×¢×Ÿ ×—×“×©×•×ª...</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ==================== CENTER COLUMN: Notices Board (Expanded) ==================== -->
            <div class="col-span-12 lg:col-span-6 flex flex-col">
                <div class="dashboard-card flex-1 flex flex-col overflow-hidden">
                    <div class="bg-gradient-to-l from-accent to-blue-600 px-4 py-3 rounded-t-2xl flex items-center justify-between">
                        <h2 class="text-lg font-bold flex items-center gap-2">ğŸ“£ ×”×•×“×¢×•×ª ×œ×“×™×™×¨×™×</h2>
                        <span class="text-sm text-blue-100" id="notices-count">0 ×”×•×“×¢×•×ª</span>
                    </div>
                    <div id="notices-content" class="notices-scroll flex-1 overflow-y-auto p-4 space-y-3">
                        <div class="text-center text-gray-400 py-16" id="no-notices">
                            <div class="text-6xl mb-4">ğŸ“­</div>
                            <p class="text-xl text-gray-500">××™×Ÿ ×”×•×“×¢×•×ª ×œ×”×¦×’×”</p>
                            <p class="text-sm text-gray-400 mt-2">×œ×—×¥ ×¢×œ "× ×™×”×•×œ" ×œ×”×•×¡×¤×ª ×”×•×“×¢×” ×—×“×©×”</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ==================== RIGHT COLUMN: Info + Shabbat (top-aligned with other blocks) ==================== -->
            <div class="col-span-12 lg:col-span-3 flex flex-col justify-start gap-4">
                <!-- Useful Information Card -->
                <div class="dashboard-card text-gray-800 overflow-hidden">
                    <div class="bg-gradient-to-l from-accent to-blue-600 px-4 py-3 rounded-t-2xl">
                        <h2 class="text-lg font-bold flex items-center gap-2">
                            <span>â„¹ï¸</span>
                            <span>××™×“×¢ ×©×™××•×©×™</span>
                        </h2>
                    </div>
                    <div class="p-4 space-y-3 text-right">
                        <!-- Trash Collection -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 text-lg flex-shrink-0">
                                ğŸ—‘ï¸
                            </div>
                            <div class="text-sm leading-relaxed">
                                <div class="font-semibold text-gray-900">×™××™ ×¤×™× ×•×™ ××©×¤×”:</div>
                                <div class="text-gray-700">×¨××©×•×Ÿ, ×©×œ×™×©×™, ×—××™×©×™</div>
                            </div>
                        </div>
                        <!-- Floor & Stairs Cleaning -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600 text-lg flex-shrink-0">
                                ğŸ§¹
                            </div>
                            <div class="text-sm leading-relaxed">
                                <div class="font-semibold text-gray-900">× ×™×§×™×•×Ÿ ×§×•××•×ª:</div>
                                <div class="text-gray-700">×©× ×™ ×•×—××™×©×™</div>
                                <div class="font-semibold text-gray-900 mt-1">× ×™×§×™×•×Ÿ ××“×¨×’×•×ª:</div>
                                <div class="text-gray-700">×©×œ×™×©×™</div>
                            </div>
                        </div>
                        <!-- Garden Waste -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 text-lg flex-shrink-0">
                                ğŸŒ¿
                            </div>
                            <div class="text-sm leading-relaxed">
                                <div class="font-semibold text-gray-900">×™××™ ×”×•×¦××ª ×’×–×:</div>
                                <div class="text-gray-700">×©×œ×™×©×™</div>
                            </div>
                        </div>
                        <!-- City Hotline -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 text-lg flex-shrink-0">
                                â˜ï¸
                            </div>
                            <div class="text-sm leading-relaxed">
                                <div class="font-semibold text-gray-900">××•×§×“ ×¢×™×¨×•× ×™ 106</div>
                            </div>
                        </div>

                        <!-- DING Billing Service -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full bg-pink-100 flex items-center justify-center text-pink-600 text-lg flex-shrink-0">
                                ğŸ’³
                            </div>
                            <div class="text-sm leading-relaxed">
                                <div class="font-semibold text-gray-900">×©×¨×•×ª ×’×‘×™×™×” DING:</div>
                                <div class="text-gray-700">×•×•××˜×¡××¤ 051â€‘5246200 | ××™×™×œ pay@oxs.co.il | ×˜×œ×¤×•×Ÿ 03â€‘5020158</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Shabbat Card with Parasha Name -->
                <div class="shabbat-card dashboard-card-dark p-6 text-center">
                    <div class="flex items-center justify-center gap-3 mb-3">
                        <div class="text-5xl">ğŸ•¯ï¸</div>
                        <h3 class="text-xl font-bold text-white">×–×× ×™ ×”×©×‘×ª</h3>
                        <div class="text-5xl">ğŸ•¯ï¸</div>
                    </div>
                    
                    <!-- Parasha Name -->
                    <p id="parsha-name" class="text-lg text-blue-200 font-medium mb-4"> ×•×™×©×œ×—</p>
                    
                    <div class="grid grid-cols-2 gap-4 mt-4">
                        <div class="bg-white/10 rounded-xl p-3">
                            <div class="text-sm text-blue-200 mb-1">×›× ×™×¡×ª ×©×‘×ª</div>
                            <div id="shabbat-entry" class="text-3xl font-bold time-display">--:--</div>
                        </div>
                        <div class="bg-white/10 rounded-xl p-3">
                            <div class="text-sm text-blue-200 mb-1">×™×¦×™××ª ×©×‘×ª</div>
                            <div id="shabbat-exit" class="text-3xl font-bold time-display">--:--</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- ==================== NEWS TICKER ==================== -->
    <footer class="fixed bottom-0 left-0 right-0 ticker-container py-2.5 px-4 shadow-lg z-30">
        <div class="flex items-center gap-4 max-w-[1920px] mx-auto">
            <a href="https://www.ynet.co.il" target="_blank" rel="noopener noreferrer" class="flex-shrink-0 hover:opacity-90 transition-opacity">
                <div class="bg-danger text-white px-4 py-1.5 rounded font-bold text-sm flex items-center gap-1">
                    <span>ğŸ“º</span><span>×—×“×©×•×ª</span>
                </div>
            </a>
            <div class="flex-1 overflow-hidden">
                <div class="marquee-content" id="news-ticker">
                    <span class="text-textSecondary">×˜×•×¢×Ÿ ××‘×–×§×™×...</span>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- ==================== ADMIN BUTTON ==================== -->
    <button onclick="openAdminPanel()" class="admin-btn fixed top-4 left-4 text-white px-4 py-2.5 rounded-xl font-semibold shadow-xl z-40 flex items-center gap-2">
        <span>âš™ï¸</span><span>× ×™×”×•×œ</span>
    </button>
    
    <!-- ==================== ADMIN MODAL ==================== -->
    <div id="admin-modal" class="fixed inset-0 modal-backdrop z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-l from-accent to-blue-600 text-white px-6 py-4 rounded-t-2xl">
                <h2 class="text-xl font-bold flex items-center gap-2">ğŸ“ × ×™×”×•×œ ×”×”×•×“×¢×•×ª</h2>
            </div>
            <div class="p-6 space-y-4">
                <div>
                    <label class="block text-gray-700 font-semibold mb-1.5 text-sm">×›×•×ª×¨×ª ×”×”×•×“×¢×” *</label>
                    <input type="text" id="notice-title" class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent text-gray-800 bg-gray-50" placeholder="×”×–×Ÿ ×›×•×ª×¨×ª..." dir="rtl">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-1.5 text-sm">×ª×•×›×Ÿ ×”×”×•×“×¢×”</label>
                    <textarea id="notice-content" rows="3" class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent text-gray-800 bg-gray-50 min-h-[80px] resize-none" placeholder="×”×–×Ÿ ×ª×•×›×Ÿ..." dir="rtl"></textarea>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-1.5 text-sm">×§×˜×’×•×¨×™×”</label>
                    <select id="notice-category" class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent text-gray-800 bg-gray-50">
                        <option value="general">ğŸ“¢ ×›×œ×œ×™</option>
                        <option value="maintenance">ğŸ”§ ×ª×—×–×•×§×”</option>
                        <option value="event">ğŸ‰ ××™×¨×•×¢</option>
                        <option value="important">âš ï¸ ×—×©×•×‘</option>
                        <option value="billing">ğŸ’³ ×—×™×•×‘</option>
                        <option value="vaad">ğŸ  ×•×¢×“ ×”×‘×™×ª</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-1.5 text-sm">×ª××¨×™×š</label>
                    <input type="date" id="notice-date" class="w-full px-4 py-2.5 border border-gray-200 rounded-xl focus:ring-2 focus:ring-accent focus:border-transparent text-gray-800 bg-gray-50">
                </div>
                <div>
                    <label class="block text-gray-700 font-semibold mb-2 text-sm">×¦×‘×¢ ×”×”×•×“×¢×”</label>
                    <div class="flex gap-3" id="color-picker">
                        <button type="button" class="color-option selected" data-color="#3b82f6" style="background-color: #3b82f6;" onclick="selectColor(this)"></button>
                        <button type="button" class="color-option" data-color="#10b981" style="background-color: #10b981;" onclick="selectColor(this)"></button>
                        <button type="button" class="color-option" data-color="#f59e0b" style="background-color: #f59e0b;" onclick="selectColor(this)"></button>
                        <button type="button" class="color-option" data-color="#ef4444" style="background-color: #ef4444;" onclick="selectColor(this)"></button>
                        <button type="button" class="color-option" data-color="#8b5cf6" style="background-color: #8b5cf6;" onclick="selectColor(this)"></button>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="notice-priority" class="w-5 h-5 text-accent rounded focus:ring-accent">
                    <label for="notice-priority" class="text-gray-700 font-medium text-sm">âš¡ ×¢×“×™×¤×•×ª ×’×‘×•×”×” (×”×•×“×¢×” ××”×‘×”×‘×ª)</label>
                </div>
            </div>
            <div class="px-6 py-4 bg-gray-50 rounded-b-2xl flex flex-wrap gap-3 justify-end border-t border-gray-100">
                <button onclick="clearForm()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-300 transition-colors text-sm">ğŸ—‘ï¸ × ×§×”</button>
                <button onclick="closeAdminPanel()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-300 transition-colors text-sm">×¡×’×•×¨</button>
                <button onclick="addNotice()" class="px-5 py-2 bg-gradient-to-l from-accent to-blue-600 text-white rounded-xl font-semibold hover:opacity-90 transition-opacity text-sm">â• ×”×•×¡×£ ×”×•×“×¢×”</button>
            </div>
        </div>
    </div>
    
    <!-- ==================== JAVASCRIPT ==================== -->
    <script>
        const CONFIG = {
            location: { name: '×‘××¨ ×™×¢×§×‘', lat: 31.9424, lon: 34.8391, geonameid: 295530 },
            // intervals in milliseconds: clock every second, news & weather every 15 minutes
            intervals: { clock: 1000, news: 900000, weather: 900000 }
        };
        
        let notices = [];
        let selectedColor = '#3b82f6';
        
        document.addEventListener('DOMContentLoaded', () => {
            loadNotices();
            updateTime();
            fetchWeather();
            fetchShabbatTimes();
            fetchNewsFromRSS();
            document.getElementById('notice-date').valueAsDate = new Date();
            setInterval(updateTime, CONFIG.intervals.clock);
            setInterval(fetchNewsFromRSS, CONFIG.intervals.news);
            setInterval(fetchWeather, CONFIG.intervals.weather);
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeAdminPanel(); });
            document.getElementById('admin-modal').addEventListener('click', (e) => { if (e.target.id === 'admin-modal') closeAdminPanel(); });
        });
        
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit', hour12: false });
            const dateStr = now.toLocaleDateString('he-IL', { year: 'numeric', month: 'long', day: 'numeric' });
            const dayStr = now.toLocaleDateString('he-IL', { weekday: 'long' });
            const shortDateStr = now.toLocaleDateString('he-IL', { day: 'numeric', month: 'short', year: 'numeric' });
            
            document.getElementById('header-time').textContent = timeStr;
            document.getElementById('header-date').textContent = shortDateStr;
            document.getElementById('header-day').textContent = dayStr;
        }
        
        async function fetchWeather() {
            try {
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${CONFIG.location.lat}&longitude=${CONFIG.location.lon}&current_weather=true`);
                if (response.ok) {
                    const data = await response.json();
                    const temp = Math.round(data.current_weather.temperature);
                    const weatherCode = data.current_weather.weathercode;
                    updateWeatherDisplay(temp, weatherCode);
                }
            } catch (error) { console.error('Weather fetch error:', error); }
        }
        
        function updateWeatherDisplay(temp, weatherCode) {
            const icons = { 0: 'â˜€ï¸', 1: 'ğŸŒ¤ï¸', 2: 'â›…', 3: 'â˜ï¸', 45: 'ğŸŒ«ï¸', 48: 'ğŸŒ«ï¸', 51: 'ğŸŒ§ï¸', 53: 'ğŸŒ§ï¸', 55: 'ğŸŒ§ï¸', 61: 'ğŸŒ§ï¸', 63: 'ğŸŒ§ï¸', 65: 'ğŸŒ§ï¸', 71: 'ğŸŒ¨ï¸', 73: 'ğŸŒ¨ï¸', 75: 'ğŸŒ¨ï¸', 77: 'ğŸŒ¨ï¸', 80: 'ğŸŒ¦ï¸', 81: 'ğŸŒ¦ï¸', 82: 'ğŸŒ¦ï¸', 85: 'ğŸŒ¨ï¸', 86: 'ğŸŒ¨ï¸', 95: 'â›ˆï¸', 96: 'â›ˆï¸', 99: 'â›ˆï¸' };
            const icon = icons[weatherCode] || 'ğŸŒ¡ï¸';
            document.getElementById('header-weather-temp').textContent = `${temp}Â°`;
            document.getElementById('header-weather-icon').textContent = icon;
        }
        
        async function fetchShabbatTimes() {
            try {
                const response = await fetch(`https://www.hebcal.com/shabbat?cfg=json&geonameid=${CONFIG.location.geonameid}&M=on`);
                if (response.ok) {
                    const data = await response.json();
                    let parsha = '', candleLighting = '--:--', havdalah = '--:--';
                    for (const item of data.items) {
                        if (item.category === 'parashat') parsha = item.hebrew || item.title;
                        else if (item.category === 'candles') candleLighting = formatTime(item.date);
                        else if (item.category === 'havdalah') havdalah = formatTime(item.date);
                    }
                    document.getElementById('parsha-name').textContent = ` ${parsha}`;
                    document.getElementById('shabbat-entry').textContent = candleLighting;
                    document.getElementById('shabbat-exit').textContent = havdalah;
                }
            } catch (error) { console.error('Shabbat times fetch error:', error); }
        }
        
        function formatTime(isoString) {
            return new Date(isoString).toLocaleTimeString('he-IL', { hour: '2-digit', minute: '2-digit', hour12: false });
        }
        
        async function fetchNewsFromRSS() {
            try {
                const rssUrl = 'http://www.ynet.co.il/Integration/StoryRss1854.xml';
                const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;
                const response = await fetch(apiUrl);
                if (response.ok) {
                    const data = await response.json();
                    if (data.status === 'ok' && data.items && data.items.length > 0) {
                        const newsItems = data.items.slice(0, 8).map(item => {
                            const pubDate = new Date(item.pubDate);
                            // Adjust by +2 hours to match local display
                            pubDate.setHours(pubDate.getHours() + 2);
                            const time = pubDate.toLocaleTimeString('he-IL', {
                                hour: '2-digit',
                                minute: '2-digit',
                                hour12: false
                            });
                            return {
                                title: item.title,
                                time,
                                url: item.link
                            };
                        });
                        updateNewsTicker(newsItems);
                        updateNewsHeadlines(newsItems.slice(0, 6));
                        return;
                    }
                }
            } catch (error) { console.error('News fetch error:', error); }
            const fallbackNews = [
                { title: '×‘×¨×•×›×™× ×”×‘××™× ×œ××œ×•× ×™× 8 - ××¡×š ×”×œ×•×‘×™ ×”×—×›× ×©×œ×›×', time: '--:--', url: '#' },
                { title: '×œ×¢×“×›×•× ×™× × ×•×¡×¤×™× ×¢×§×‘×• ××—×¨ ×œ×•×— ×”×”×•×“×¢×•×ª', time: '--:--', url: '#' }
            ];
            updateNewsTicker(fallbackNews);
            updateNewsHeadlines(fallbackNews);
        }
        
        function updateNewsTicker(newsItems) {
            const ticker = document.getElementById('news-ticker');
            const newsHtml = newsItems.map(item => `
                <span class="inline-flex items-center mx-6">
                    <span class="ynet-icon mr-2">y</span>
                    <span class="text-danger font-bold ml-2">${item.time}</span>
                    <a href="${item.url}" target="_blank" rel="noopener noreferrer" class="text-white hover:text-accentLight transition-colors">${escapeHtml(item.title)}</a>
                    <span class="mx-4 text-white/30">|</span>
                </span>
            `).join('');
            ticker.innerHTML = newsHtml + newsHtml;
        }
        
        function updateNewsHeadlines(newsItems) {
            const container = document.getElementById('news-headlines');
            container.innerHTML = newsItems.map(item => `
                <a href="${item.url}" target="_blank" rel="noopener noreferrer" class="block p-3 rounded-lg hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0">
                    <div class="flex items-start gap-3">
                        <div class="w-14 h-14 bg-gradient-to-br from-blue-100 to-blue-50 rounded-lg flex items-center justify-center flex-shrink-0">
                            <div class="ynet-icon">y</div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-gray-800 text-sm font-medium leading-snug line-clamp-2">${escapeHtml(item.title)}</p>
                            <p class="text-gray-400 text-xs mt-1">${item.time}</p>
                        </div>
                    </div>
                </a>
            `).join('');
        }
        
        function loadNotices() {
            const stored = localStorage.getItem('lobby-notices');
            if (stored) { notices = JSON.parse(stored); renderNotices(); }
        }
        
        function saveNotices() { localStorage.setItem('lobby-notices', JSON.stringify(notices)); }
        
        function renderNotices() {
            const container = document.getElementById('notices-content');
            const noNotices = document.getElementById('no-notices');
            const countEl = document.getElementById('notices-count');
            if (notices.length === 0) { noNotices.style.display = 'block'; countEl.textContent = '0 ×”×•×“×¢×•×ª'; return; }
            noNotices.style.display = 'none';
            countEl.textContent = `${notices.length} ×”×•×“×¢×•×ª`;
            container.querySelectorAll('.notice-item').forEach(el => el.remove());
            notices.forEach(notice => { container.insertBefore(createNoticeElement(notice), noNotices); });
        }
        
        function createNoticeElement(notice) {
            const div = document.createElement('div');
            div.className = `notice-item p-4 ${notice.priority ? 'priority-notice' : ''}`;
            div.style.borderRightColor = notice.color;
            div.dataset.id = notice.id;
            const emojis = { general: 'ğŸ“¢', maintenance: 'ğŸ”§', event: 'ğŸ‰', important: 'âš ï¸', billing: 'ğŸ’³', vaad: 'ğŸ ' };
            const names = { general: '×›×œ×œ×™', maintenance: '×ª×—×–×•×§×”', event: '××™×¨×•×¢', important: '×—×©×•×‘', billing: '×—×™×•×‘', vaad: '×•×¢×“ ×”×‘×™×ª' };
            const dateStr = new Date(notice.date).toLocaleDateString('he-IL');
            div.innerHTML = `
                <div class="flex justify-between items-start gap-3">
                    <div class="flex-1">
                        <div class="flex items-center gap-2 mb-1">
                            <span class="text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600">${emojis[notice.category] || 'ğŸ“¢'} ${names[notice.category] || '×›×œ×œ×™'}</span>
                            <span class="text-xs text-gray-400">${dateStr}</span>
                        </div>
                        <h4 class="font-bold text-base text-gray-800" style="color: ${notice.color}">${escapeHtml(notice.title)}</h4>
                        ${notice.content ? `<p class="text-gray-600 text-sm mt-1.5 leading-relaxed notice-content">${escapeHtml(notice.content)}</p>` : ''}
                    </div>
                    <button onclick="deleteNotice('${notice.id}')" class="text-gray-300 hover:text-danger transition-colors p-1 rounded-lg hover:bg-red-50" title="××—×§ ×”×•×“×¢×”">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>
            `;
            return div;
        }
        
        function addNotice() {
            const title = document.getElementById('notice-title').value.trim();
            const content = document.getElementById('notice-content').value.trim();
            const category = document.getElementById('notice-category').value;
            const date = document.getElementById('notice-date').value;
            const priority = document.getElementById('notice-priority').checked;
            if (!title) { alert('× × ×œ×”×–×™×Ÿ ×›×•×ª×¨×ª ×œ×”×•×“×¢×”'); document.getElementById('notice-title').focus(); return; }
            notices.unshift({ id: Date.now().toString(), title, content, category, date: date || new Date().toISOString().split('T')[0], color: selectedColor, priority });
            saveNotices(); renderNotices(); clearForm(); closeAdminPanel();
        }
        
        function deleteNotice(id) { if (confirm('×”×× ×œ××—×•×§ ××ª ×”×”×•×“×¢×”?')) { notices = notices.filter(n => n.id !== id); saveNotices(); renderNotices(); } }
        
        function openAdminPanel() { document.getElementById('admin-modal').classList.remove('hidden'); document.getElementById('notice-title').focus(); }
        function closeAdminPanel() { document.getElementById('admin-modal').classList.add('hidden'); }
        
        function clearForm() {
            document.getElementById('notice-title').value = '';
            document.getElementById('notice-content').value = '';
            document.getElementById('notice-category').value = 'general';
            document.getElementById('notice-date').valueAsDate = new Date();
            document.getElementById('notice-priority').checked = false;
            document.querySelectorAll('.color-option').forEach(btn => { btn.classList.remove('selected'); if (btn.dataset.color === '#3b82f6') btn.classList.add('selected'); });
            selectedColor = '#3b82f6';
        }
        
        function selectColor(button) {
            document.querySelectorAll('.color-option').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            selectedColor = button.dataset.color;
        }
        
        function escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; }
    </script>
</body>
</html>
